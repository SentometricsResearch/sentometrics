<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predicting the VIX index â€¢ sentometrics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Predicting the VIX index">
<meta property="og:description" content="sentometrics">
<meta property="og:image" content="https://sentometricsresearch.github.io/sentometrics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sentometrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/sentometrics.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Tutorials</li>
    <li>
      <a href="../../articles/examples/corpus.html">Corpus manipulation</a>
    </li>
    <li>
      <a href="../../articles/examples/sentiment.html">Sentiment computation</a>
    </li>
    <li>
      <a href="../../articles/examples/indexation.html">Index aggregation</a>
    </li>
    <li>
      <a href="../../articles/examples/modeling.html">Modeling</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Applications</li>
    <li>
      <a href="../../articles/applications/epu.html">Creating EPU indices</a>
    </li>
    <li>
      <a href="../../articles/applications/vix.html">Predicting the VIX index</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Contributions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/contributions/gopress.html">Analyzing Gopress data</a>
    </li>
    <li>
      <a href="../../articles/contributions/isa.html">Intratextual sentiment analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/development.html">Development</a>
    </li>
    <li>
      <a href="../../news/index.html">Releases</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SentometricsResearch/sentometrics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vix_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Predicting the VIX index</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SentometricsResearch/sentometrics/blob/master/vignettes/applications/vix.Rmd"><code>vignettes/applications/vix.Rmd</code></a></small>
      <div class="hidden name"><code>vix.Rmd</code></div>

    </div>

    
    
<p>In this application, we show a recommended workflow to predict a variable, in this case the stock market volatility VIX index, using textual sentiment indices. It takes over and explains the example provided in the <a href="https://doi.org/10.2139/ssrn.3067734">vignette</a>.</p>
<div id="load-packages" class="section level4">
<h4 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://sentometrics-research.com/sentometrics/">"sentometrics"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://quanteda.io">"quanteda"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.structuraltopicmodel.com/">"stm"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/trinker/lexicon">"lexicon"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="convert-the-built-in-corpus-into-a-sento_corpus-object" class="section level4">
<h4 class="hasAnchor">
<a href="#convert-the-built-in-corpus-into-a-sento_corpus-object" class="anchor"></a>Convert the built-in corpus into a <code>sento_corpus</code> object</h4>
<p>First, transform the built-in corpus of 4145 U.S. news articles between 1995 and 2014 into a <code>sento_corpus</code> object. This corpus object is the best basis for the later addition of new metadata features, and the aggregation into textual sentiment time series.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uscorpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sento_corpus.html">sento_corpus</a></span><span class="op">(</span><span class="fu">sentometrics</span><span class="fu">::</span><span class="va"><a href="../../reference/usnews.html">usnews</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="fit-a-topic-model" class="section level4">
<h4 class="hasAnchor">
<a href="#fit-a-topic-model" class="anchor"></a>Fit a topic model</h4>
<p>To enrich the corpus, we fit a topic model to uncover a set of different latent items discussed across the news. To do the preprocessing into a document-term matrix, we use the <strong><code>quanteda</code></strong> package. The <strong><code>stm</code></strong> package is used to extract 8 topics.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/tokens.html">tokens</a></span><span class="op">(</span><span class="va">uscorpus</span>, what <span class="op">=</span> <span class="st">"word"</span>, remove_punct <span class="op">=</span> <span class="cn">TRUE</span>, remove_numbers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://quanteda.io/reference/dfm.html">dfm</a></span><span class="op">(</span>tolower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://quanteda.io/reference/dfm_select.html">dfm_remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html">stopwords</a></span><span class="op">(</span><span class="st">"en"</span><span class="op">)</span>, min_nchar <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://quanteda.io/reference/dfm_trim.html">dfm_trim</a></span><span class="op">(</span>min_termfreq <span class="op">=</span> <span class="fl">0.95</span>, termfreq_type <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://quanteda.io/reference/dfm_trim.html">dfm_trim</a></span><span class="op">(</span>max_docfreq <span class="op">=</span> <span class="fl">0.10</span>, docfreq_type <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://quanteda.io/reference/dfm_subset.html">dfm_subset</a></span><span class="op">(</span><span class="fu"><a href="https://quanteda.io/reference/ntoken.html">ntoken</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">topicModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/stm/man/stm.html">stm</a></span><span class="op">(</span><span class="va">dfm</span>, K <span class="op">=</span> <span class="fl">8</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">topTerms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/stm/man/labelTopics.html">labelTopics</a></span><span class="op">(</span><span class="va">topicModel</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">[[</span><span class="st">"prob"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="va">topTerms</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="co"># first 4 (out of 8) topics</span></code></pre></div>
<pre><code>##      [,1]          [,2]       [,3]        [,4]      
## [1,] "funds"       "banks"    "labor"     "tax"     
## [2,] "fund"        "credit"   "reported"  "budget"  
## [3,] "bonds"       "debt"     "decline"   "house"   
## [4,] "capital"     "loans"    "second"    "congress"
## [5,] "investments" "mortgage" "economist" "bush"</code></pre>
</div>
<div id="use-the-topic-model-output-to-enrich-the-corpus-with-features" class="section level4">
<h4 class="hasAnchor">
<a href="#use-the-topic-model-output-to-enrich-the-corpus-with-features" class="anchor"></a>Use the topic model output to enrich the corpus with features</h4>
<p>A list of keywords that defines the new features is based on the 5 top terms associated to each of the 8 topics. We insert this list of keywords into the <code><a href="../../reference/add_features.html">add_features()</a></code> function. A feature value per news article, normalized between 0 and 1, is generated for each topic, depending on how often the 5 relevant words appear in the news.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">keywords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">topTerms</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">topTerms</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">keywords</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"TOPIC_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">keywords</span><span class="op">)</span><span class="op">)</span>
<span class="va">uscorpus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/add_features.html">add_features</a></span><span class="op">(</span><span class="va">uscorpus</span>, keywords <span class="op">=</span> <span class="va">keywords</span>, do.binary <span class="op">=</span> <span class="cn">FALSE</span>, do.regex <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://quanteda.io/reference/docvars.html">docvars</a></span><span class="op">(</span><span class="va">uscorpus</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"uncertainty"</span>, <span class="st">"election"</span>, <span class="st">"economy"</span>, <span class="st">"noneconomy"</span>, <span class="st">"wsj"</span>, <span class="st">"wapo"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://quanteda.io/reference/docvars.html">docvars</a></span><span class="op">(</span><span class="va">uscorpus</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## TOPIC_1 TOPIC_2 TOPIC_3 TOPIC_4 TOPIC_5 TOPIC_6 TOPIC_7 TOPIC_8 
##    1111    1101    1389     648     954    1005    1052     856</code></pre>
<p>The final topic features distribution in the corpus is different than what is reported in the vignette. This is due to fundamental changes within the <strong><code>quanteda</code></strong> package regarding their tokenization. The sensitivity of the topical output is a good reminder about the importance of optimizing the preprocessing and the topic modeling itself (which is not dealt with in detail here).</p>
</div>
<div id="prepare-the-sentiment-lexicons" class="section level4">
<h4 class="hasAnchor">
<a href="#prepare-the-sentiment-lexicons" class="anchor"></a>Prepare the sentiment lexicons</h4>
<p>In total, we will compute the textual sentiment using 9 lexicons, here prepared (mainly cleaned and made coherent) into a <code>sento_lexicons</code> object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lexiconsIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="fu">sentometrics</span><span class="fu">::</span><span class="va"><a href="../../reference/list_lexicons.html">list_lexicons</a></span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LM_en"</span>, <span class="st">"HENRY_en"</span>, <span class="st">"GI_en"</span><span class="op">)</span><span class="op">]</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    NRC <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_nrc.html">hash_sentiment_nrc</a></span>,
    HULIU <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_huliu.html">hash_sentiment_huliu</a></span>,
    SENTIWORD <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_sentiword.html">hash_sentiment_sentiword</a></span>,
    JOCKERS <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_jockers.html">hash_sentiment_jockers</a></span>,
    SENTICNET <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_senticnet.html">hash_sentiment_senticnet</a></span>,
    SOCAL <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_socal_google.html">hash_sentiment_socal_google</a></span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">lex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sento_lexicons.html">sento_lexicons</a></span><span class="op">(</span>lexiconsIn <span class="op">=</span> <span class="va">lexiconsIn</span>,
                      valenceIn <span class="op">=</span> <span class="fu">sentometrics</span><span class="fu">::</span><span class="va"><a href="../../reference/list_valence_shifters.html">list_valence_shifters</a></span><span class="op">[[</span><span class="st">"en"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div id="define-the-sentiment-index-aggregation-specifications" class="section level4">
<h4 class="hasAnchor">
<a href="#define-the-sentiment-index-aggregation-specifications" class="anchor"></a>Define the sentiment index aggregation specifications</h4>
<p>All the sentiment computation and aggregation parameters are specified in the <code><a href="../../reference/ctr_agg.html">ctr_agg()</a></code> function. We go for daily textual sentiment time series as 270-day moving averages using Beta weighting schemes. On a given day, all documents are weighted equally. The individual news sentiment scores are normalized by the number of detected lexicon words (these words are referred to as polarized).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctrAggPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/ctr_agg.html">ctr_agg</a></span><span class="op">(</span>
  howWithin <span class="op">=</span> <span class="st">"proportionalPol"</span>,
  howDocs <span class="op">=</span> <span class="st">"equal_weight"</span>,
  howTime <span class="op">=</span> <span class="st">"beta"</span>, by <span class="op">=</span> <span class="st">"day"</span>, fill <span class="op">=</span> <span class="st">"latest"</span>, lag <span class="op">=</span> <span class="fl">270</span>, aBeta <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, bBeta <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="aggregate-the-corpus-into-textual-sentiment-time-series" class="section level4">
<h4 class="hasAnchor">
<a href="#aggregate-the-corpus-into-textual-sentiment-time-series" class="anchor"></a>Aggregate the corpus into textual sentiment time series</h4>
<p>Calling the <code><a href="../../reference/sento_measures.html">sento_measures()</a></code> function with the corpus, lexicons and aggregation specifications defined before creates the many sentiment time series.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sentMeasPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sento_measures.html">sento_measures</a></span><span class="op">(</span><span class="va">uscorpus</span>, lexicons <span class="op">=</span> <span class="va">lex</span>, ctr <span class="op">=</span> <span class="va">ctrAggPred</span><span class="op">)</span>

<span class="fu"><a href="../../reference/nmeasures.html">nmeasures</a></span><span class="op">(</span><span class="va">sentMeasPred</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 432</code></pre>
<p>You can plot the measures very simply. Below, the plot shows the sentiment time series averaged per feature.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sentMeasPred</span>, group <span class="op">=</span> <span class="st">"features"</span><span class="op">)</span></code></pre></div>
<p><img src="vix_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="retrieve-the-vix-data" class="section level4">
<h4 class="hasAnchor">
<a href="#retrieve-the-vix-data" class="anchor"></a>Retrieve the VIX data</h4>
<p>We need time series data about the VIX index to predict it. An object with this information is stored on our GitHub repository, and can be retrieved as below. The data are monthly.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://cran.r-project.org/package=repmis">"repmis"</a></span><span class="op">)</span>

<span class="va">vixObject</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/sborms/sentometrics/blob/master/examples/vix.rda?raw=true"</span>
<span class="fu"><a href="https://rdrr.io/pkg/repmis/man/source_data.html">source_data</a></span><span class="op">(</span><span class="va">vixObject</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "vix"</code></pre>
</div>
<div id="align-the-sentiment-measures-and-the-vix-data" class="section level4">
<h4 class="hasAnchor">
<a href="#align-the-sentiment-measures-and-the-vix-data" class="anchor"></a>Align the sentiment measures and the VIX data</h4>
<p>To make sure the sentiment measures and the VIX data are aligned date-wise, we perform some rearrangements.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sentMeasIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">sentMeasPred</span>, <span class="va">date</span> <span class="op">%in%</span> <span class="va">vix</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>
<span class="va">datesIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/get_dates.html">get_dates</a></span><span class="op">(</span><span class="va">sentMeasIn</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">vix</span><span class="op">[</span><span class="va">vix</span><span class="op">$</span><span class="va">date</span> <span class="op">%in%</span> <span class="va">datesIn</span>, <span class="va">value</span><span class="op">]</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>lag <span class="op">=</span> <span class="va">y</span><span class="op">)</span></code></pre></div>
</div>
<div id="prepare-the-regression-model-specifications" class="section level4">
<h4 class="hasAnchor">
<a href="#prepare-the-regression-model-specifications" class="anchor"></a>Prepare the regression model specifications</h4>
<p>The regression model we will run is the high-dimensional elastic net regression, given that we have many explanatory sentiment variables. For details about the high-dimensional regression framework, see the <strong><code>glmnet</code></strong> package. We want to do a true out-of-sample analysis rolling forward through time, hence we set <code>do.iter = TRUE</code> and define a sample size of 60. We are trying to predict the VIX variable 6 months ahead (<code>h = 6</code>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctrIter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/ctr_model.html">ctr_model</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"gaussian"</span>,
                     type <span class="op">=</span> <span class="st">"BIC"</span>,
                     h <span class="op">=</span> <span class="fl">6</span>,
                     alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">1</span><span class="op">)</span>,
                     do.iter <span class="op">=</span> <span class="cn">TRUE</span>,
                     oos <span class="op">=</span> <span class="fl">5</span>, <span class="co"># h - 1</span>
                     nSample <span class="op">=</span> <span class="fl">60</span>,
                     nCore <span class="op">=</span> <span class="fl">1</span>,
                     do.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="fit-and-assess-the-elastic-net-model-iteratively-over-time" class="section level4">
<h4 class="hasAnchor">
<a href="#fit-and-assess-the-elastic-net-model-iteratively-over-time" class="anchor"></a>Fit and assess the elastic net model iteratively over time</h4>
<p>The <code><a href="../../reference/sento_model.html">sento_model()</a></code> function runs the model estimations iteratively and keeps track of the out-of-sample performance. Through the <code>x</code> argument, we slide the VIX index as autoregressive component into the regression equation. Omit this argument if you only want to use the sentiment variables as explanatory variables.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sento_model.html">sento_model</a></span><span class="op">(</span><span class="va">sentMeasIn</span>, x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, ctr <span class="op">=</span> <span class="va">ctrIter</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></code></pre></div>
<pre><code>## Model specification 
## - - - - - - - - - - - - - - - - - - - - 
##  
## Model type: gaussian 
## Calibration: via BIC information criterion 
## Sample size: 60 
## Total number of iterations/predictions: 161 
## Optimal average elastic net alpha parameter: 0.92 
## Optimal average elastic net lambda parameter: 2.8 
##  
## Out-of-sample performance 
## - - - - - - - - - - - - - - - - - - - - 
##  
## Mean directional accuracy: 47.5 % 
## Root mean squared prediction error: 10.42 
## Mean absolute deviation: 8.2</code></pre>
<p>The out-of-sample predictions versus the realized values are displayed in following plot. The predictions are not that bad, though they lag the true VIX evolutions. The coefficient attached to the lagged value of the VIX itself dominates often.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></code></pre></div>
<p><img src="vix_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="compute-and-plot-the-sentiment-attributions" class="section level4">
<h4 class="hasAnchor">
<a href="#compute-and-plot-the-sentiment-attributions" class="anchor"></a>Compute and plot the sentiment attributions</h4>
<p>As a diagnostic tool, one can compute the prediction attributions to the various dimensions of the sentiment measures (the features, the lexicons, and the time weighting schemes). This way, visualizations can show which elements steer the predictions and when.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">attr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/attributions.html">attributions</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">sentMeasIn</span>, do.lags <span class="op">=</span> <span class="cn">FALSE</span>, do.normalize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">attr</span>, group <span class="op">=</span> <span class="st">"features"</span><span class="op">)</span></code></pre></div>
<p><img src="vix_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">attr</span>, group <span class="op">=</span> <span class="st">"lexicons"</span><span class="op">)</span></code></pre></div>
<p><img src="vix_files/figure-html/unnamed-chunk-16-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.linkedin.com/in/sam-borms">Samuel Borms</a>, <a href="https://ardiad.github.io">David Ardia</a>, <a href="https://www.kevenbluteau.com">Keven Bluteau</a>, <a href="https://linkedin.com/in/krisboudt">Kris Boudt</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '29d61aa2be101325ab9a82514b58064b',
    indexName: 'sentometrics',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
